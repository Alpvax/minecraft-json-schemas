{
    "$schema": "http://json-schema.org/draft-07/schema",
    "$id": "https://raw.githubusercontent.com/Levertion/minecraft-json-schema/master/java/shared/text_component.json",
    "$ref": "#/definitions/text_component",
    "definitions": {
        "text_component": {
            "anyOf": [
                {
                    "type": "string",
                    "title": "Plain text shorthand",
                    "description": "Equivalent to {\"text\":\"<value>\"}"
                },
                {
                    "$ref": "#/definitions/text_object"
                },
                {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/text_component"
                    },
                    "title": "Text component array",
                    "description": "Equivalent to firstItem, with \"extra\":[...<nextItems>]"
                }
            ]
        },
        "text_object": {
            "type": "object",
            "oneOf": [
                {
                    "properties": {
                        "text": {
                            "type": "string",
                            "title": "The direct text to use"
                        }
                    },
                    "required": ["text"],
                    "not": {
                        "required": ["with", "interpret"],
                        "$comment": "All other cases are automatically handled by the oneOf"
                    }
                },
                {
                    "properties": {
                        "translate": {
                            "type": "string",
                            "title": "The translation string to translate"
                        },
                        "with": {
                            "type": "array",
                            "title": "Replacements",
                            "description": "Extra items to apply in place of %s and %{x}$s in the translation string. These items inherit from the base component in styling, such as text colour and italics",
                            "items": {
                                "$ref": "#/definitions/text_component"
                            }
                        }
                    },
                    "not": {
                        "required": ["interpret"],
                        "$comment": "All other cases are automatically handled by the oneOf"
                    },
                    "required": ["translate"]
                },
                {
                    "properties": {
                        "score": {
                            "title": "A score to display",
                            "additionalProperties": false,
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "title": "Entity selector whose score to show"
                                },
                                "objective": {
                                    "type": "string",
                                    "title": "Objective to show score from"
                                },
                                "value": {
                                    "type": ["number", "string", "boolean"],
                                    "title": "A default when score not found",
                                    "description": "Will be converted to a string if needed"
                                }
                            }
                        }
                    },
                    "not": {
                        "required": ["with", "interpret"],
                        "$comment": "All other cases are automatically handled by the oneOf"
                    },
                    "required": ["score"]
                },
                {
                    "properties": {
                        "selector": {
                            "type": "string",
                            "pattern": "^@[parse]",
                            "title": "An entity to mention",
                            "description": "If there are multiple, they will be comma seperated until the last value with an 'and'"
                        }
                    },
                    "not": {
                        "required": ["with", "interpret"],
                        "$comment": "All other cases are automatically handled by the oneOf"
                    },
                    "required": ["selector"]
                },
                {
                    "properties": {
                        "keybind": {
                            "type": "string",
                            "title": "The name of the keybind to show"
                        }
                    },
                    "not": {
                        "required": ["with", "interpret"],
                        "$comment": "All other cases are automatically handled by the oneOf"
                    },
                    "required": ["keybind"]
                },
                {
                    "properties": {
                        "nbt": {
                            "type": "string",
                            "title": "An NBT path",
                            "description": "Displays the nbt at this path of the selected entity/block or `[]` if unavailable "
                        },
                        "interpet": {
                            "type": "boolean",
                            "title": "Interpret NBT as chat component"
                        }
                    },
                    "oneOf": [
                        {
                            "properties": {
                                "selector": {
                                    "type": "string",
                                    "pattern": "^@[parse]",
                                    "title": "The entity to select"
                                }
                            },
                            "required": ["selector"]
                        },
                        {
                            "properties": {
                                "block": {
                                    "type": "object",
                                    "title": "The coordinates of the block to ask about",
                                    "properties": {
                                        "x": { "type": "number" },
                                        "y": { "type": "number" },
                                        "z": { "type": "number" }
                                    },
                                    "required": ["x", "y", "z"],
                                    "additionalProperties": false
                                }
                            },
                            "required": ["block"]
                        }
                    ],
                    "not": {
                        "required": ["with"],
                        "$comment": "All other cases are automatically handled by the oneOf"
                    },
                    "required": ["nbt"]
                }
            ],
            "additionalProperties": false,
            "properties": {
                "text": {},
                "translate": {},
                "with": {},
                "score": {},
                "selector": {},
                "keybind": {},
                "nbt": {},
                "block": {},
                "interpret": {},
                "extra": {
                    "type": "array",
                    "$ref": "#/definitions/text_component",
                    "title": "Additional items to add",
                    "description": "These items inherit from the base component in styling, such as text colour and italics"
                },
                "color": {
                    "title": "The colour of the text",
                    "enum": [
                        "black",
                        "dark_blue",
                        "dark_green",
                        "dark_aqua",
                        "dark_red",
                        "dark_purple",
                        "gold",
                        "gray",
                        "dark_gray",
                        "blue",
                        "green",
                        "aqua",
                        "red",
                        "light_purple",
                        "yellow",
                        "white",
                        "reset"
                    ]
                },
                "bold": {
                    "title": "Whether to have the text bold",
                    "type": "boolean"
                },
                "italic": {
                    "title": "Whether to have the text in italics",
                    "type": "boolean"
                },
                "underlined": {
                    "title": "Whether to have the text underlined",
                    "type": "boolean"
                },
                "strikethrough": {
                    "title": "Whether to have the text strikethroughed",
                    "type": "boolean"
                },
                "obfuscated": {
                    "title": "Whether to have the text obfuscated",
                    "description": "This makes the text cycle through characters with the same width",
                    "type": "boolean"
                },
                "insertion": {
                    "title": "Insertion text",
                    "description": "When the player SHIFT-clicks on a section of text, what to add to their chat window",
                    "type": "string"
                },
                "clickEvent": {
                    "type": "object",
                    "title": "Action on click",
                    "description": "Action to perform when this text is left clicked on",
                    "additionalProperties": false,
                    "properties": {
                        "action": {
                            "enum": [
                                "open_url",
                                "run_command",
                                "change_page",
                                "suggest_command"
                            ],
                            "title": "Action to perform",
                            "description": "'open_url' opens the web address in '\"value\"', 'run_command' runs the command (use /trigger), change_page changes the book page, and suggest_command replaces the player's chat box with the value"
                        },
                        "value": {
                            "type": "string",
                            "title": "Value to run action with",
                            "description": "See the properties of action"
                        }
                    }
                },
                "hoverEvent": {
                    "additionalProperties": false,
                    "description": "What to show upon a hover",
                    "anyOf": [
                        {
                            "type": "object",
                            "properties": {
                                "action": {
                                    "type": "string",
                                    "enum": ["show_text"]
                                },
                                "value": {
                                    "$ref": "#/definitions/text_component"
                                }
                            }
                        },
                        {
                            "type": "object",
                            "properties": {
                                "action": {
                                    "enum": ["show_item", "show_entity"]
                                },
                                "value": {
                                    "type": "string"
                                }
                            }
                        }
                    ]
                }
            }
        }
    }
}
