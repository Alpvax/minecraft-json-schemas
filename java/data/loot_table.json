{
    "$schema": "http://json-schema.org/schema#",
    "$id": "https://raw.githubusercontent.com/Levertion/minecraft-json-schemas/master/java/data/loot_table_strict.json",
    "type": "object",
    "title": "Loot table root",
    "defaultSnippets": [
        {
            "label": "Empty loot table",
            "body": {
                "pools": "^[$1]"
            }
        }
    ],
    "additionalProperties": false,
    "properties": {
        "type": {
            "enum": [
                "minecraft:empty",
                "minecraft:chest",
                "minecraft:fishing",
                "minecraft:entity",
                "minecraft:advancement_reward",
                "minecraft:block"
            ],
            "title": "Validates function uses",
            "description": "Used to validate function use. If a function cannot be used for the type, an error is given",
            "$comment": "Currently unused, but could potentially be used in the future"
        },
        "functions": {
            "type": "array",
            "title": "Table functions",
            "description": "The functions applied to this table. These are applied to every item given",
            "items": {
                "$ref": "#/definitions/function"
            }
        },
        "pools": {
            "type": "array",
            "title": "Loot pools",
            "items": {
                "additionalProperties": false,
                "type": "object",
                "properties": {
                    "conditions": {
                        "$ref": "#/definitions/conditions",
                        "title": "Pool conditions",
                        "description": "The conditions which must pass in order for this pool to be used"
                    },
                    "functions": {
                        "type": "array",
                        "title": "Pool functions",
                        "description": "The functions applied to this pool. These are applied to every item",
                        "items": {
                            "$ref": "#/definitions/function"
                        }
                    },
                    "rolls": {
                        "$ref": "#/definitions/random_range",
                        "title": "Number of rolls",
                        "description": "Each roll selects one entry from 'entries', chosen randomly based on its weight"
                    },
                    "bonus_rolls": {
                        "$ref": "#/definitions/random_range",
                        "title": "Bonus rolls",
                        "description": "The additional 'rolls' given for each point of luck"
                    },
                    "entries": {
                        "type": "array",
                        "title": "The entries",
                        "description": "For each roll, one of these entries is chosen to be given, with a chance based on the 'weight'",
                        "items": {}
                    }
                },
                "required": ["entries"]
            }
        }
    },
    "definitions": {
        "condition": {
            "type": "object",
            "required": ["condition"],
            "oneOf": [
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:entity_properties"],
                            "title": "Test entity properties",
                            "descriptions": "Test whether the entity specified in 'entity' matches the 'predicate'"
                        },
                        "entity": {
                            "$ref": "#/definitions/entity"
                        },
                        "predicate": {
                            "$ref": "../shared/predicate.json#/definitions/entity"
                        }
                    },
                    "required": ["entity", "predicate"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:entity_scores"]
                        },
                        "entity": {
                            "$ref": "#/definitions/entity"
                        },
                        "scores": {
                            "type": "object",
                            "title": "Scores to check",
                            "description": "The name of each sub-object is the score to check, it is either a number or a range",
                            "additionalProperties": {
                                "$ref": "../shared/range.json"
                            }
                        }
                    },
                    "required": ["entity", "scores"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:random_chance"],
                            "title": "Random Chance",
                            "description": "A random chance (ignoring looting) that the condition will pass"
                        },
                        "chance": {
                            "type": "number",
                            "minimum": 0,
                            "maximum": 1,
                            "title": "Chance",
                            "description": "The chance that the condition will pass. i.e 0.3 means 30% chance."
                        }
                    },
                    "required": ["condition", "chance"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:random_chance_with_looting"],
                            "title": "Looting Chance",
                            "description": "A random chance taking looting into account that the condition will pass"
                        },
                        "chance": {
                            "type": "number",
                            "minimum": 0,
                            "maximum": 1,
                            "title": "Base chance",
                            "description": "The base chance that the condition will pass without any looting. i.e 0.3 means 30% chance."
                        },
                        "looting_multiplier": {
                            "type": "number",
                            "title": "Looting multiplier",
                            "description": "The extra chance each level of looting adds to success"
                        }
                    },
                    "required": ["condition", "chance", "lotting_multiplier"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:killed_by_player"],
                            "description": "This condition will pass only if the mob was killed by a player, unless the 'inverse' condition is set"
                        },
                        "inverse": {
                            "type": "boolean",
                            "title": "Inverse",
                            "description": "If true, the condition will only pass if the entity is not killed by a player"
                        }
                    }
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:alternative"],
                            "title": "Concurrent conditions",
                            "descriptions": "If any of the conditions in 'terms' is true, the entire condition is true"
                        },
                        "terms": {
                            "$ref": "#/definitions/conditions/items"
                        }
                    },
                    "required": ["terms"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:block_state_property"],
                            "title": "Block state properties",
                            "descriptions": "Checks the block states and type of the block being broken"
                        },
                        "block": {
                            "$ref": "../shared/block_name.json#"
                        },
                        "properties": {
                            "type": "object",
                            "title": "A map of property to values",
                            "additionalProperties": { "type": "string" }
                        }
                    },
                    "required": ["block"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:damage_source_properties"],
                            "title": "Damage source properties",
                            "descriptions": "Tests information about the damage source"
                        },
                        "predicate": {
                            "$ref": "../shared/predicate.json#/definitions/damage",
                            "title": "The damage to be tested against"
                        }
                    },
                    "required": ["predicate"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:entity_present"],
                            "title": "Test if entity exists",
                            "description": "Returns true if kind described in 'entity' is set"
                        },
                        "entity": {
                            "$ref": "#/definitions/entity",
                            "title": "The kind of entity"
                        }
                    },
                    "required": ["entity"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:inverted"],
                            "title": "Conditions inverse",
                            "descriptions": "Returns true if the condition in 'term' failed"
                        },
                        "term": { "$ref": "#/definitions/condition" }
                    },
                    "required": ["term"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:location_check"],
                            "title": "Check location",
                            "descriptions": "Checks the location predicate described in 'predicate'"
                        },
                        "predicate": {
                            "$ref": "../shared/predicate.json#/definitions/location"
                        }
                    },
                    "required": ["predicate"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:match_tool"],
                            "title": "Check tool",
                            "descriptions": "Available for block breaking and fishing"
                        },
                        "predicate": {
                            "$ref": "../shared/predicate.json#/definitions/item"
                        }
                    },
                    "required": ["predicate"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:survives_explosion"],
                            "title": "Explosion survival",
                            "descriptions": "Returns true with 1/<explosion radius> chance if the cause of dropping was an explosion, or true otherwise"
                        }
                    }
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:table_bonus"],
                            "title": "Bonus for enchantment levels",
                            "descriptions": "Passes with a certain probability when the tool has a given enchantment\n Used for fortune enchantments"
                        },
                        "enchantment": {
                            "$ref": "../shared/enchantment_name.json#"
                        },
                        "chances": {
                            "type": "array",
                            "items": { "type": "number" },
                            "title": "Level probabilities",
                            "description": "List of probabilities for enchantment level (first index is chance for no enchantment)"
                        }
                    },
                    "required": ["enchantment", "chances"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "condition": {
                            "enum": ["minecraft:weather_check"],
                            "title": "Check the weather"
                        },
                        "raining": {
                            "type": "boolean"
                        },
                        "thundering": {
                            "type": "boolean"
                        }
                    }
                }
            ]
        },
        "conditions": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/condition"
            }
        },
        "entity": {
            "title": "Entity to test",
            "description": "'this' for the entity which died to make the loot table, 'killer' for the entity which killed the entity, and 'killer_player' for the player who killed the entity (if it exists), 'direct_killer' for the direct entity which killed the entity (e.g. a shot arrow)",
            "enum": ["this", "killer", "killer_player", "direct_killer"]
        },
        "entry": {
            "type": "object",
            "oneOf": [
                {
                    "properties": {
                        "type": {
                            "enum": ["item"],
                            "title": "Item",
                            "description": "This entry will give an item (if the conditions pass). The item type is defined in \"name\""
                        },
                        "name": {
                            "$ref": "../shared/item_name.json",
                            "title": "Item",
                            "description": "The item to give"
                        },
                        "functions": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/function"
                            }
                        }
                    }
                },
                {
                    "properties": {
                        "type": {
                            "enum": ["loot_table"],
                            "title": "Loot table",
                            "description": "This entry will give the result of another loot table specified in 'name'. These cannot be self referencing in any way, if they are self referencing, they don't run"
                        },
                        "name": {
                            "$ref": "../shared/namespaced_location.json",
                            "title": "Loot table",
                            "description": "The loot table to be given"
                        }
                    }
                },
                {
                    "properties": {
                        "type": {
                            "enum": ["empty"],
                            "title": "Empty",
                            "description": "An empty pool. No items will be granted"
                        }
                    }
                }
            ],
            "required": ["type"],
            "properties": {
                "quality": {
                    "type": "number",
                    "title": "Weight based on luck",
                    "description": "Change the weight based on the players' luck attribute. This is calculated by weight + (quality * luck)"
                },
                "weight": {
                    "type": "number",
                    "title": "Chance of this entry being used",
                    "description": "The chance of this entry being used"
                },
                "type": {},
                "name": {},
                "functions": {}
            },
            "additionalProperties": false
        },
        "function": {
            "title": "Function",
            "description": "This is a function which changes the properties of an item",
            "required": ["function"],
            "oneOf": [
                {
                    "additionalProperties": false,
                    "properties": {
                        "function": {
                            "enum": ["minecraft:set_count", "set_count"],
                            "title": "Set Number",
                            "description": "Set the 'count' of the items. Can be either an integer or a range. If it is a range it is set randomly within that range"
                        },
                        "count": {
                            "$ref": "../shared/range.json",
                            "description": "The exact value or a range to choose a random value from to set the count to"
                        }
                    }
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "function": {
                            "enum": ["minecraft:set_data", "set_data"],
                            "title": "Set Data",
                            "description": "Sets the 'Damage' nbt tag to either the specified number or a random number within a given range"
                        },
                        "data": {
                            "$ref": "../shared/range.json",
                            "description": "The exact value or a range to choose a random value from to set the 'Damage' tag to"
                        }
                    }
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "function": {
                            "enum": ["minecraft:set_damage", "set_damage"],
                            "title": "Set durability %",
                            "description": "Sets the percentage of the maximum durability"
                        },
                        "damage": {
                            "$ref": "../shared/range.json",
                            "description": "The data value or a random value in a range to set the 'durability' to. 0.35 means 35% durability left"
                        }
                    }
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "function": {
                            "enum": ["minecraft:set_nbt", "set_nbt"],
                            "title": "Set nbt",
                            "description": "A function to set the 'tag' nbt of the item to the value specified in 'nbt'"
                        },
                        "tag": {
                            "type": "string",
                            "title": "NBT string",
                            "description": "A string of nbt, which is escaped using the json format (a \\ in front of each \\ or \")"
                        }
                    }
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "function": {
                            "enum": [
                                "minecraft:set_attributes",
                                "set_attributes"
                            ]
                        },
                        "modifiers": {
                            "type": "array",
                            "title": "Modifiers",
                            "description": "A list of modifiers to apply to the item.",
                            "items": {
                                "additionalProperties": false,
                                "title": "A single modifier",
                                "required": [
                                    "attribute",
                                    "name",
                                    "amount",
                                    "operation",
                                    "slot"
                                ],
                                "properties": {
                                    "attribute": {
                                        "enum": [
                                            "generic.maxHealth",
                                            "generic.followRange",
                                            "generic.knockbackResistance",
                                            "generic.movementSpeed",
                                            "generic.attackDamage",
                                            "generic.armor",
                                            "generic.armorToughness"
                                        ],
                                        "title": "Attribute to apply",
                                        "description": "The attribute modifier to apply to the item."
                                    },
                                    "name": {
                                        "title": "Custom name",
                                        "description": "The name of the attribute. Can be any string",
                                        "type": "string"
                                    },
                                    "amount": {
                                        "$ref": "../shared/range.json",
                                        "title": "Modification amount",
                                        "description": "The amount to change the attribute by. This can either be a single number or a range, with a `min` and `max` key"
                                    },
                                    "operation": {
                                        "enum": [
                                            "addition",
                                            "multiply_base",
                                            "multiply_total"
                                        ],
                                        "title": "Attribute to apply",
                                        "description": ""
                                    },
                                    "slot": {
                                        "title": "Applied slot",
                                        "description": "The slot to apply the attribute to. Can either be an array or a single string. If it is an array, it chooses one of the slots randomly",
                                        "oneOf": [
                                            {
                                                "type": "array",
                                                "items": {
                                                    "enum": [
                                                        "mainhand",
                                                        "offhand",
                                                        "feet",
                                                        "legs",
                                                        "chest",
                                                        "head"
                                                    ]
                                                }
                                            },
                                            {
                                                "enum": [
                                                    "mainhand",
                                                    "offhand",
                                                    "feet",
                                                    "legs",
                                                    "chest",
                                                    "head"
                                                ]
                                            }
                                        ]
                                    },
                                    "id": {
                                        "title": "String UUID (optional)",
                                        "description": "A uuid to give to the attribute. If left blank it is randomised. They can be specified to allow (for example), items to be identical or to overwrite specific attributes by using another item (buggy)",
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "function": {
                            "enum": [
                                "minecraft:enchant_randomly",
                                "enchant_randomly"
                            ],
                            "title": "Choose random enchantment",
                            "description": "Chooses a random enchantment from the enchantments list. If it is not specified, a random enchantment (which is compatible with the item) will be applied instead"
                        },
                        "enchantments": {
                            "type": "array",
                            "items": {
                                "$ref": "../shared/enchantment_name.json"
                            },
                            "title": "Enchantments",
                            "description": "The enchantments to choose from to apply to the item"
                        }
                    }
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "function": {
                            "enum": [
                                "minecraft:enchant_with_levels",
                                "enchant_with_levels"
                            ],
                            "title": "Enchanting table",
                            "description": "Enchants the item randomly as if it were enchanted. The levels key is a range object (either an integer or an object). If \"treasure\" is true, then the enchantment may use treasure enchantments (mending or frost-walker)"
                        },
                        "levels": {
                            "$ref": "../shared/range.json"
                        },
                        "treasure": {
                            "type": "boolean",
                            "title": "Use treasure enchantments?",
                            "description": "Whether the enchantment can include treasure enchantments (such as mending and frost walker)"
                        }
                    },
                    "required": ["levels"]
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "function": {
                            "enum": [
                                "minecraft:looting_enchant",
                                "looting_enchant"
                            ],
                            "title": "Extra items with looting",
                            "description": "How many extra items to add for each level of the looting enchantment applied. For example, a count of 10 with a looting level of 5 would give an extra 50 items"
                        },
                        "count": {
                            "$ref": "../shared/range.json",
                            "description": "The exact value or a range to choose a random value from to add to the count for each level of looting"
                        },
                        "limit": {
                            "type": "number",
                            "title": "Maximum",
                            "description": "The maximum number of additional items available"
                        }
                    }
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "function": {
                            "enum": [
                                "minecraft:furnace_smelt",
                                "furnace_smelt"
                            ],
                            "title": "Smelt if possible",
                            "description": "If possible, smelt the item. If it can't be smelted, nothing happens."
                        }
                    }
                }
            ]
        },
        "random_range": {
            "defaultSnippets": [
                { "label": "Exact value", "body": "^${1:1}" },
                {
                    "label": "Random Choice between 'min' and 'max'",
                    "body": {
                        "type": "${1|minecraft:uniform,minecraft:binomial|}",
                        "min": "^${2:0}",
                        "max": "^${3:2}"
                    }
                }
            ],
            "oneOf": [
                { "type": "integer", "title": "Exactly this many" },
                {
                    "type": "object",
                    "properties": {
                        "type": {
                            "enum": ["minecraft:constant"]
                        },
                        "value": {
                            "type": "integer",
                            "title": "Exactly this many"
                        }
                    },
                    "required": ["value"]
                },
                {
                    "type": "object",
                    "properties": {
                        "type": {
                            "enum": ["minecraft:uniform", "minecraft:binomial"],
                            "description": "The random number generator to use"
                        },
                        "min": {
                            "title": "Minimum random number (inclusive)",
                            "type": "integer"
                        },
                        "max": {
                            "title": "Maximum random number (inclusive)",
                            "type": "integer"
                        }
                    },
                    "required": ["type", "min", "max"]
                }
            ]
        }
    }
}
